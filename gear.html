<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gear</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            /* text-align: left; */
        }

        .h1 {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .h4 {
            text-align: left;
        }

        .ul {
            text-align: left;
        }

        .redboxes-horz {
            position: relative;
            /* border: 1px solid blue; */
            width: 500px;
            height: 100px;
            left: 200px;
            top: 100px;
        }
            </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
    <h1 class="h1">Gear</h1>


    <h1>Rows with Dates in Column A</h1>
<div id="sheet-data">Loading...</div>

<script>
  const sheetId = '1OgXTyzDbJdPTa_rPElYegiECC5xrhchCnsrzkOL113c'; // <-- Replace
  const apiKey = 'AIzaSyAIgkgBmYU2urtbz5e9K-f13EJs411TUVk';   // <-- Replace
  const range = 'Sheet1!A1:I20';   // <-- Adjust as needed

  fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`)
    .then(res => res.json())
    .then(data => {
      const rows = data.values || [];
      const header = rows[0];
      const dataRows = rows.slice(1);

      // Utility: check if a value is a date
      function isLikelyDate(value) {
        return !isNaN(Date.parse(value));
      }

      const table = document.createElement('table');
      const thead = document.createElement('thead');
      const tbody = document.createElement('tbody');

      // Table header
      const trHead = document.createElement('tr');
      header.forEach(col => {
        const th = document.createElement('th');
        th.textContent = col;
        trHead.appendChild(th);
      });
      thead.appendChild(trHead);

      // Table body - only rows where Column A is a valid date
      dataRows.forEach(row => {
        const cellA = row[0];
        if (isLikelyDate(cellA)) {
          const tr = document.createElement('tr');
          header.forEach((_, i) => {
            const td = document.createElement('td');
            td.textContent = row[i] ?? '';
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        }
      });

      table.appendChild(thead);
      table.appendChild(tbody);

      const output = document.getElementById('sheet-data');
      output.innerHTML = ''; // Clear loading text
      output.appendChild(table);
    })
    .catch(error => {
      document.getElementById('sheet-data').textContent = 'Error loading data.';
      console.error('Error:', error);
    });
</script>

    
</body>
</html>
